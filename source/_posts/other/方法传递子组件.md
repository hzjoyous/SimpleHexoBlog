---
title: 方法传递子组件
date: '2020-01-31T14:06:00+08:00'
tags:
    - react
    - php
categories:
    - code

---



`从实现上来看类似发布订阅，但从思路上来说并不完全一样，设计上侧重点有些许不同`

今天看React中传递方法给子组件，因为传递的是方法，父组件控制逻辑，子组件控制调用，潜意识认为这是一种不可靠，不易维护的方法，但是react是推荐这种方式的，于是进一步思考了一下。
发现每一步的职责都很清晰并没有混乱的发生

这个流程可以这样划分`子组件`包括子组件本身功能+触发，同时提供一个明确的绑定方式，并且明确回调中会传递的值，
`父组件`提供父组件相关操作，开发只需要对两个组件进行绑定即刻
如下php代码，下面绑定了一个匿名函数，模块的拼接者只需要按需转换即刻

```php
// 这里是对子组件的提交事件进行了绑定，当子组件进行提交操作的时候触发，会传递子组件预定义好的数据，这里进行处理转化，然后传入$f中
$s->submitBind(function ($value) use ($f) {
    $name = $value;
    $f->push(['name' => $name]);
});
```

与发布订阅，有些类似但又不同

下面是一段php父模块传递方法


```php
<?php

class Son
{

    private $value = '';

    private $callback = null;

    public function input($value)
    {
        $this->value = $value;
    }

    public function submit()
    {
        ($this->callback)($this->value);
    }

    public function submitBind($callback)
    {
        $this->callback = $callback;
    }
}

class Father
{
    public $state;

    public function __construct()
    {
        $this->state = [
            ['name' => 'xxx']
        ];
    }

    public function push($name)
    {
        $this->state[] = $name;
    }

    public function upload()
    {
        return  $this->state;
    }
}

$f = new Father();
$s = new Son();
$s->submitBind(function ($value) use ($f) {
    $name = $value;
    $f->push(['name' => $name]);
});

$s->input('小张');
$s->submit();



var_dump($f->upload());

```

<!--more-->


